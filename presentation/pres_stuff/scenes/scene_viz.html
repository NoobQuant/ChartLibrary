<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<!-- Basic utilities of AnimationLib-->
<script type="text/javascript" src="../../pres_stuff/basic_utils/basic_utils.js"></script> 

<!-- d3-->
<script src="https://d3js.org/d3.v4.js" charset="utf-8"></script>





</head>

<style>


</style>

<body>


<script>

var curTime = 0;

// Animation function
function animate() {
  swarm.node.attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; })

}

var width = 1910,
    height = 1080;

var svg = d3.select("body").append("div").append("svg")
    // Scalable svg 
    .attr('viewBox','0 0 ' + width + ' ' + height)
    .attr('preserveAspectRatio','xMidYMid meet')
    .style("width", '98%')
    .style("height", '98%')
    .style("display", "block")
    .style("position", "absolute");

// For recording
var xArray = [];
var yArray = [];
var colorArray = [];
var timeArray = [];

// Create nodes data
var numberNodes = 60;
var nodes = d3.range(numberNodes).map(function(d,i) {

    if (i <= 20) {
      crtid = i <= 2 ? 4 : 3 
    } else {
      crtid = i <= 28 ? 2 : 1 
    }     
  
  return { 
          name: i
          ,groupid: crtid          
          ,xCenter: 1000
          ,yCenter: 700        
          ,color: "#666da3"
          ,radius: 20
          ,x: 800
          ,y: 500
          ,fixed: true             
        }
});

// Initiate swarm
const swarm = new ForceSwarm(nodes);

// Start drawing sequence
var timing = 0;

// Draw at intial position



swarm.simulation.restart().on('tick',animate);
swarm.restart(nodes);
swarm.restart(nodes);



var counter = 0;
var xlocs = [0, 100, 1800, 400, 1000, 1100, 1400, 1700, 600, 850];
var ylocs = [5, 100, 1000, 900, 200, 5, 400, 800, 800, 200];
var colors = d3.schemeCategory10;

d3.interval(function() {

  var randint = Math.floor(Math.random() * 11)  

  nodes.push({

          "name": "new_node" + counter
          ,"groupid": 4         
          ,"xCenter": 1000
          ,"yCenter": 700         
          ,"color": colors[randint]
          ,"radius": 20
          ,"x": xlocs[randint]
          ,"y": ylocs[randint]
          ,fixed: true    
        });

    swarm.restart(nodes);
    swarm.restart(nodes); 
               
    counter = counter + 1;

}, 2000);




</script> 

</body>
</html>